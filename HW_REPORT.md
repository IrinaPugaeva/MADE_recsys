# Отчет по дз

## Описание подходов по улучшению рекомендательной системы:

### Первый подход
Первая идея заключалась в улучшении работы нейросетевого рекомендера, построенного на семинаре. Суть - обогащение выборки для обучения без новых данных - для этого я взяла табличку pairs, полученные на семинаре эмбеддинги для context и track. Из множкства всех треков для каждого трека-контекст убираю его треки , которые следуют за ним (вторые в паре), после чего из оставшегося множества сэмплирую случайным образом треки и соединяю их в пару с треком-контекстом, время для них - 0.0. После снова для этих пар треков запускаю процесс обучения эмбеддингов. В этом подходе также экспериментировала и с кол-вом случайно выбранных новых треков (до 10 новых реков для трека-контекста пополняют выборку на 50 000 пар), и с размером эмбеддингов. Но этот подход не дал результатов. Метрика ниже, чем для исходного рекоммендера, хотя test_loss на обучении был ниже (0.08 vs 0.1). Также в рамках этого подхода поробовала покластеризовать данные (чтобы подбирать треки в пары из разных кластеров вместо случайного подбора), на context-эсбеддингах получила интересный результат при попытке отрисовать точки в пространстве с помощью tsne  - видимо, он связан с тем, что у нас есть два преобладающих множества пар в обучающей выборке - с временем 0 и временем 1 (в целом, подход подробно описан, т к на него ушло больше времени, чем на второй).

![tsne](https://github.com/IrinaPugaeva/MADE_recsys/blob/master/3.png)

### Второй подход
Основная идея та же - улучшение нейросетевого рекоммендера. Я добавила информацию об исполнителях в виде эмбеддингов (эмбедднгов артистов), которые конкатенируются к эмбеддингам треков (context и track) - код смотри в ноутбуке `My_contextuel_recommender.ipynb` . Данный подход дал значительное улучшение.

## Последовательность действий для получения рекомендация и аб-тестирования:
 - Данные для обучения (данные с семинара на каггл загружены) https://www.kaggle.com/datasets/splav12341/mobod-dataset
 - Ноутбук для обучения `My_contextuel_recommender.ipynb`
 - Получаем файл с рекомендациями: `tracks_with_recs`
 - Идем в botify - здесь:
 ```sh
 docker-compose stop
 ``` 
 - если контейер запущен
 ```sh
 docker-compose up -d --build 
 ``` 
 ```sh
 docker logs recommender-container
 ``` 
 - идем в sim - здесь:
 ```sh
 python sim/run.py --episodes 1000 --config config/env.yml single --recommender remote --seed 31337  
 ```
 - данные копируем в локальную папку
 ```sh
 docker cp recommender-container:/app/log/ /Users/username/logs
 ```
 - запускаем ноутбук с первого семинара
### Результаты 
 ![было](https://github.com/IrinaPugaeva/MADE_recsys/blob/master/1.png)

 ![стало](https://github.com/IrinaPugaeva/MADE_recsys/blob/master/2.png)

## Изменения
В исходном коде были сделаны следующие изменения:

 - порт был изменен с 5000 на 5001

 - добавлен файл setup.py для установки модуля sim